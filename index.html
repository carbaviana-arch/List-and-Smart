<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Le Cellier</title>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Rye&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --vino:#6b2e2e;
    --vino-osc:#4d1f1f;
    --papel:#f7f3ee;
    --papel2:#f2ede7;
    --tinta:#3f332a;
    --dorado:#b49773;
    --dorado-osc:#9d7f53;
    --marcado:#f9ebd8;
    --caro-borde:#a86e33;
    --ok:#3d6b47;
    --peligro:#b94848;
  }

  * { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; }
  body {
    font-family: 'Playfair Display', serif;
    background: var(--papel);
    color: var(--tinta);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  header {
    background: var(--dorado);
    color: #fdf8ee;
    font-family: 'Rye', cursive;
    font-size: 2.8rem;
    text-align: center;
    padding: 16px 0 14px;
    letter-spacing: 2px;
    text-shadow: 0 2px 0 rgb(0 0 0 / 10%);
    box-shadow: 0 3px 10px rgb(157 127 83 / 35%);
    user-select: none;
  }

  .content {
    flex: 1;
    overflow-y: auto;
    padding: 14px 16px 110px;
  }

  .agregar-form {
    background: var(--papel2);
    border: 2px solid #c7b79e;
    border-radius: 12px;
    padding: 10px;
    display: grid;
    grid-template-columns: 1fr 1fr 110px 120px;
    gap: 8px;
    align-items: center;
  }

  .agregar-form input,
  .agregar-form select,
  .agregar-form button {
    font-family: 'Playfair Display', serif;
    font-size: 1rem;
    border: 1.5px solid #ad977a;
    background: #fbf8f3;
    color: var(--tinta);
    border-radius: 8px;
    padding: 8px 10px;
  }

  .agregar-form button {
    background: var(--dorado);
    color: #fff7e6;
    border: none;
    font-weight: 700;
    cursor: pointer;
    transition: .2s ease;
    font-family: 'Rye', cursive;
  }
  .agregar-form button:hover { background: var(--dorado-osc); }

  @media (max-width:520px) {
    .agregar-form {
      grid-template-columns: 1fr 1fr;
    }
    .agregar-form button {
      grid-column: 1 / -1;
    }
  }

  #lista {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 12px;
  }

  .item {
    background: #f8f4ec;
    border: 1.5px solid #c7b79e;
    border-radius: 12px;
    padding: 12px 14px;
    display: grid;
    grid-template-columns: 1fr auto auto auto auto;
    grid-template-areas: "nombre menos cantidad mas subtotal borrar";
    align-items: center;
    gap: 8px;
    transition: transform .2s ease, opacity .2s ease, background-color .2s ease, box-shadow .2s ease;
  }
  .item.comprado {
    opacity: .55;
    background: #e9e3d7;
    font-style: italic;
  }
  .item.item-caro {
    background: var(--marcado);
    border-color: var(--caro-borde);
    box-shadow: 0 0 0 2px rgb(168 110 51 / 15%) inset;
  }

  .nombre {
    grid-area: nombre;
    font-weight: 700;
    color: #2c221b;
    cursor: pointer;
    user-select: none;
    font-family: 'Rye', cursive;
  }

  .btn-cant {
    background: var(--dorado);
    color: #fff6e0;
    border: none;
    border-radius: 8px;
    padding: 4px 10px;
    font-weight: 800;
    cursor: pointer;
    transition: .15s ease;
    font-family: 'Rye', cursive;
  }
  .btn-cant:hover { background: var(--dorado-osc); }

  .menos { grid-area: menos; }
  .mas { grid-area: mas; }

  .cantidad {
    grid-area: cantidad;
    min-width: 24px;
    text-align: center;
    font-weight: 700;
  }

  .subtotal {
    grid-area: subtotal;
    min-width: 70px;
    text-align: right;
    font-weight: 700;
  }

  .btn-borrar {
    grid-area: borrar;
    background: transparent;
    border: none;
    font-size: 1.25rem;
    color: var(--peligro);
    cursor: pointer;
    padding-left: 6px;
    opacity: .9;
    transition: transform .15s ease, opacity .15s ease, color .2s ease;
  }
  .btn-borrar:hover {
    transform: scale(1.1);
    opacity: 1;
    color: #8f2f2f;
  }

  .item.swiping {
    box-shadow: 0 6px 16px rgb(0 0 0 / 12%);
  }

  .resumen {
    background: var(--papel2);
    border: 2px solid #c7b79e;
    border-radius: 12px;
    padding: 14px;
  }
  .resumen p {
    margin: .35rem 0;
    font-weight: 600;
  }

  .presupuesto-box {
    background: var(--papel2);
    border: 2px solid #c7b79e;
    border-radius: 12px;
    padding: 14px;
    display: grid;
    gap: 10px;
  }
  .barra {
    height: 10px;
    background: #e7dccb;
    border-radius: 999px;
    overflow: hidden;
    border: 1px solid #c7b79e;
  }
  .barra > div {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--vino), var(--dorado));
    transition: width .3s ease;
  }

  .dock {
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: 0;
    width: 100%;
    max-width: 560px;
    background: var(--dorado);
    border-top: 3px solid var(--dorado-osc);
    display: flex;
    justify-content: space-around;
    padding: 10px 6px;
    box-shadow: 0 -4px 14px rgb(157 127 83 / 55%);
    z-index: 1500;
    border-radius: 18px 18px 0 0;
  }
  .dock button {
    background: none;
    border: none;
    color: #fff8e9;
    font-size: 1.6rem;
    cursor: pointer;
    padding: 4px 8px;
    transition: transform .15s ease, opacity .2s ease;
    opacity: .85;
    font-family: 'Rye', cursive;
  }
  .dock button[aria-selected="true"] {
    transform: scale(1.12);
    opacity: 1;
  }
  .dock button:hover {
    opacity: 1;
  }

  .price-tag {
    position: fixed;
    right: 16px;
    bottom: 86px;
    background: #fffdf7;
    color: var(--vino);
    border: 2px solid var(--vino-osc);
    border-radius: 10px 10px 10px 0;
    padding: 10px 14px 10px 28px;
    font-weight: 700;
    box-shadow: -2px 3px 0 var(--vino-osc), 0 6px 16px rgb(0 0 0 / 18%);
    transform: rotate(-4deg);
    z-index: 1400;
    font-family: 'Rye', cursive;
  }
  .price-tag:before {
    content: '';
    position: absolute;
    left: 10px;
    top: 14px;
    width: 10px;
    height: 10px;
    border: 2px solid var(--vino-osc);
    border-radius: 50%;
    background: #fffdf7;
  }
  .price-tag small {
    display: block;
    font-weight: 700;
    color: #7c5b5b;
  }
  .hidden { display: none; }

  button:focus, input:focus, select:focus {
    outline: 2px solid var(--dorado-osc);
    outline-offset: 2px;
  }
</style>
</head>
<body>

<header>Le Cellier</header>

<div class="content" id="listaTab">
  <form class="agregar-form" id="formAgregar" onsubmit="return false;">
    <input type="text" id="inputNombre" placeholder="Producto" aria-label="Nombre del producto" required />
    <select id="inputCategoria" aria-label="CategorÃ­a (opcional)">
      <option value="">CategorÃ­a (opcional)</option>
      <option>Frutas</option>
      <option>Verduras</option>
      <option>LÃ¡cteos</option>
      <option>Carnes</option>
      <option>Bebidas</option>
      <option>Despensa</option>
      <option>Higiene y Cuidado Personal</option>
      <option>LavanderÃ­a</option>
      <option>Limpieza</option>
      <option>Congelados</option>
      <option>Fitness</option>
      <option>Otros</option>
    </select>
    <input type="number" id="inputPrecio" placeholder="Precio (â‚¬)" min="0" step="0.01" required />
    <button id="btnAgregar" type="submit">AÃ±adir</button>
  </form>
  <div id="lista" aria-live="polite"></div>
</div>

<div class="content hidden" id="resumenTab">
  <div class="resumen" id="resumen" aria-live="polite" aria-label="Resumen por categorÃ­a"></div>
</div>

<div class="content hidden" id="presupuestoTab">
  <div class="presupuesto-box">
    <label for="presupuesto">Presupuesto (â‚¬):</label>
    <input type="number" id="presupuesto" min="0" step="0.01" />
    <div class="barra"><div id="barraLlena"></div></div>
    <p id="estadoPresupuesto"></p>
  </div>
</div>

<nav class="dock" role="tablist" aria-label="PestaÃ±as">
  <button role="tab" aria-controls="listaTab" aria-selected="true" tabindex="0" onclick="mostrarTab('listaTab')">ðŸ“‹</button>
  <button role="tab" aria-controls="resumenTab" aria-selected="false" tabindex="-1" onclick="mostrarTab('resumenTab')">ðŸ“Š</button>
  <button role="tab" aria-controls="presupuestoTab" aria-selected="false" tabindex="-1" onclick="mostrarTab('presupuestoTab')">ðŸ’°</button>
</nav>

<div id="priceTag" class="price-tag">
  <small>Restante</small>
  <span id="restanteTexto">â€”</span>
</div>

<script>
  // El JS permanece igual...
  let listaCompras = JSON.parse(localStorage.getItem('listaCompras')) || [];
  let presupuesto = parseFloat(localStorage.getItem('presupuesto')) || 0;
  // ... (mantÃ©n todo tu script sin cambios)
  function guardar() { localStorage.setItem('listaCompras', JSON.stringify(listaCompras)); localStorage.setItem('presupuesto', String(presupuesto || 0)); }
  // (incluye el resto del JS tal cual como ya lo tenÃ­as)
  // ... hasta renderLista, renderResumen, actualizarPresupuestoUI, tabs, etc.
</script>
</body>
</html>
